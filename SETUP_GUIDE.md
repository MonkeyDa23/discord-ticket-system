# دليل إعداد نظام إدارة التذاكر المتكامل

## الخطوة 1: إعداد قاعدة البيانات MySQL

### 1.1 إنشاء قاعدة البيانات
1. افتح phpMyAdmin أو MySQL Workbench
2. انقر على "استيراد" أو "Import" 
3. اختر ملف `database_setup.sql` من المشروع
4. انقر "تنفيذ" لإنشاء قاعدة البيانات والجداول

### 1.2 إعداد متغيرات البيئة
أضف متغيرات قاعدة البيانات التالية:
```
DATABASE_URL=mysql://username:password@localhost:3306/ticket_system
PGHOST=localhost
PGPORT=3306
PGUSER=your_mysql_username
PGPASSWORD=your_mysql_password
PGDATABASE=ticket_system
```

## الخطوة 2: إعداد Discord Bot

### 2.1 إنشاء التطبيق في Discord
1. اذهب إلى [Discord Developer Portal](https://discord.com/developers/applications)
2. انقر "New Application" وأدخل اسم التطبيق
3. انتقل لقسم "Bot" وانقر "Add Bot"
4. انسخ Token الخاص بالبوت

### 2.2 إعداد متغيرات Discord
```
DISCORD_BOT_TOKEN=your_bot_token_here
DISCORD_GUILD_ID=your_server_id
DISCORD_CHANNEL_ID=channel_for_account_requests
```

### 2.3 دعوة البوت للسيرفر
1. انتقل لقسم "OAuth2" > "URL Generator"
2. اختر scope: `bot` و `applications.commands`
3. اختر الصلاحيات: `Send Messages`, `Manage Channels`, `Read Message History`
4. انسخ الرابط المُنشأ وافتح في المتصفح لدعوة البوت

## الخطوة 3: إعداد SendGrid للبريد الإلكتروني

### 3.1 إنشاء حساب SendGrid
1. سجل في [SendGrid](https://sendgrid.com)
2. اذهب لقسم "Settings" > "API Keys"
3. أنشئ API Key جديد

### 3.2 إضافة متغير البيئة
```
SENDGRID_API_KEY=your_sendgrid_api_key
```

## الخطوة 4: نظام الموافقة على الحسابات

### 4.1 كيفية عمل النظام
1. المستخدم يقدم طلب إنشاء حساب من `/auth/request-account`
2. يتم إرسال إشعار لسيرفر Discord مع بيانات الطلب
3. الإدارة تراجع الطلب وتختار نوع الحساب (مدير/مستخدم عادي)
4. عند الموافقة، يتم إنشاء الحساب تلقائياً

### 4.2 أنواع الحسابات
- **مدير**: وصول كامل لجميع أقسام لوحة التحكم
- **مستخدم عادي**: وصول محدود للإعدادات الأساسية فقط

## الخطوة 5: نشر المشروع

### 5.1 إعداد Replit
1. تأكد من إضافة جميع متغيرات البيئة في Secrets
2. شغل المشروع بالأمر `npm run dev`
3. انقر "Deploy" لنشر المشروع على رابط خاص

### 5.2 إعداد الدومين المخصص
1. في إعدادات Deployment، أضف دومينك المخصص
2. قم بتحديث DNS records للدومين
3. تأكد من تحديث `REPLIT_DOMAINS` في متغيرات البيئة

## الخطوة 6: اختبار النظام

### 6.1 اختبار طلب الحساب
1. اذهب لـ `/auth/request-account`
2. املأ النموذج بالبيانات المطلوبة
3. تحقق من وصول الإشعار لسيرفر Discord
4. اختبر الموافقة/الرفض من Discord

### 6.2 اختبار لوحة التحكم
1. سجل دخول بحساب مدير
2. اختبر جميع الأقسام: التذاكر، المراجعات، الإعدادات
3. اختبر أوامر Discord Bot بالأمر `/setup`

## الميزات الأساسية

✅ **نظام موافقة متقدم**: لا يتم إنشاء الحسابات إلا بعد موافقة الإدارة
✅ **تصنيف الحسابات**: مدير أو مستخدم عادي مع صلاحيات مختلفة  
✅ **تكامل Discord**: إشعارات تلقائية وإدارة الطلبات من Discord
✅ **قاعدة بيانات MySQL**: حفظ آمن لجميع البيانات
✅ **واجهة عربية متقدمة**: تصميم احترافي مع تأثيرات بصرية
✅ **نظام أمان عالي**: تشفير كلمات المرور ومراقبة النشاطات

## الدعم الفني

في حالة مواجهة مشاكل:
1. تحقق من logs في console
2. تأكد من صحة متغيرات البيئة
3. اختبر اتصال قاعدة البيانات
4. تحقق من صلاحيات Discord Bot